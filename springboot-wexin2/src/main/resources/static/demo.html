<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>æµ‹è¯•jssdk</title>
    <!--å¼•å…¥å¾®ä¿¡JSæ–‡ä»¶-->
    <script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js" type="text/javascript"></script>
    <!--å¼•å…¥jquery-->
    <script src="/jquery-2.1.1.min.js"></script>
    <script src="/jquery.js"></script>
<script>
    //è·å–å½“å‰é¡µé¢åœ°å€
    var url = window.location.href;
    //è°ƒå–åå°æ¥å£è·å–æƒé™éªŒè¯é…ç½®
    $.ajax({
        type : "get",
        /*ï¼ï¼ï¼åˆ‡è®°åˆ°æ—¶å€™æ”¹æˆè‡ªå·±çš„*/
        url : "http://"+"xzkeji.cn"+"/weixin/initWXJSSDKConfigInfo?url="+url,//æ›¿æ¢ç½‘å€ï¼Œxxxæ ¹æ®è‡ªå·±jssdkæ–‡ä»¶ä½ç½®ä¿®æ”¹
        success : function(data){
            console.log("è¿”å›å€¼ä¸º=" + data);
            var msg = "";
            if(data.success){
                msg = JSON.parse(data.msg);
            }
            //é€šè¿‡configæ¥å£æ³¨å…¥æƒé™éªŒè¯é…ç½®
            wx.config({
                debug: true, // å¼€å¯è°ƒè¯•æ¨¡å¼,è°ƒç”¨çš„æ‰€æœ‰apiçš„è¿”å›å€¼ä¼šåœ¨å®¢æˆ·ç«¯alertå‡ºæ¥ï¼Œè‹¥è¦æŸ¥çœ‹ä¼ å…¥çš„å‚æ•°ï¼Œå¯ä»¥åœ¨pcç«¯æ‰“å¼€ï¼Œå‚æ•°ä¿¡æ¯ä¼šé€šè¿‡logæ‰“å‡ºï¼Œä»…åœ¨pcç«¯æ—¶æ‰ä¼šæ‰“å°
                appId: msg.appid,
                timestamp: msg.timestamp,
                nonceStr: msg.nonceStr,
                signature: msg.signature,
                /*ï¼ï¼ï¼åˆ‡è®°åˆ°æ—¶å€™æŒ‰éœ€è‡ªå·±é€‰æ‹©ï¼Œå‚è€ƒæ–‡æ¡£å¡«å†™*/
                jsApiList: [
                    "onMenuShareAppMessage",//åˆ†äº«ç»™å¥½å‹
                    "chooseImage",
                    "onMenuShareQQ",
                    "onMenuShareTimeline"
                ]
            });
        },
        error:function(data){
            alert(JSON.stringify(data));
        }
    });

    //é€šè¿‡readyæ¥å£å¤„ç†æˆåŠŸéªŒè¯
    wx.ready(function (){
        wx.checkJsApi({
            jsApiList: ['chooseImage','onMenuShareAppMessage'],
            success: function (res) {JSON.stringify(res)}
        });

        var shareData = {
            title: 'æ ‡é¢˜ï¼šæµ‹è¯•å¾®ä¿¡åˆ†äº«',
            desc: 'ç®€ä»‹ï¼šæµ‹è¯•å¾®ä¿¡åˆ†äº«æµ‹è¯•å¾®ä¿¡åˆ†äº«æµ‹è¯•å¾®ä¿¡åˆ†äº«æµ‹è¯•å¾®ä¿¡åˆ†äº«æµ‹è¯•å¾®ä¿¡åˆ†äº«',//è¿™é‡Œè¯·ç‰¹åˆ«æ³¨æ„æ˜¯è¦å»é™¤html
            link: url,
            imgUrl: 'https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=3080194764,1306521378&fm=15&gp=0.jpg',
            success: function (res) {
                alert('å·²åˆ†äº«');
            },
        };
        wx.onMenuShareQQ(shareData)
        wx.onMenuShareTimeline(shareData)
        wx.onMenuShareAppMessage(shareData);


    });
    //ä»ç›¸å†Œé€‰å–å›¾ç‰‡
    function wxchooseImage(){
        wx.chooseImage({
            count: 1, // é»˜è®¤9
            sizeType: ['original', 'compressed'], // å¯ä»¥æŒ‡å®šæ˜¯åŸå›¾è¿˜æ˜¯å‹ç¼©å›¾ï¼Œé»˜è®¤äºŒè€…éƒ½æœ‰
            sourceType: ['album', 'camera'], // å¯ä»¥æŒ‡å®šæ¥æºæ˜¯ç›¸å†Œè¿˜æ˜¯ç›¸æœºï¼Œé»˜è®¤äºŒè€…éƒ½æœ‰
            success: function (res) {
                var localIds = res.localIds; // è¿”å›é€‰å®šç…§ç‰‡çš„æœ¬åœ°IDåˆ—è¡¨ï¼ŒlocalIdå¯ä»¥ä½œä¸ºimgæ ‡ç­¾çš„srcå±æ€§æ˜¾ç¤ºå›¾ç‰‡
                alert("ä½ çš„å›¾ç‰‡è½¬æˆåœ°å€æ˜¯ğŸ‘‰"+localIds)
            }
        });
    }
</script>
</head>
<body>
<button onclick="wxchooseImage();">ç‚¹æˆ‘é€‰å–ç›¸å†Œ</button>
</body>
</html>